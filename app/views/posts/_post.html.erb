<%= turbo_frame_tag dom_id(post) do %>
  <div class="text-black ml-[20px] mt-[20px] mb-[20px]">
      <div class="flex mb-[10px] items-center relative">
        <div class="post-avatar">
            <% if post.user %>
            <%= link_to user_path(post.user), data: { turbo: false } do %>
                <% if post.user.avatar.attached? %>
                    <%= image_tag post.user.avatar.variant(resize_to_limit: [50, 50]), class: 'w-[50px] h-[50px] rounded-full object-cover object-center border-3 border-gray-300 mr-[15px]', alt: "#{post.user.email}'s avatar" %>
                <% else %>
                    <%= image_tag 'default_avatar.png', class: 'w-[50px] h-[50px] rounded-full object-cover object-center border-3 border-gray-300 mr-[15px]', alt: 'Default avatar' %>
                <% end %>
              <% end %>
            <% end %>
        </div>

        <div>
            <% if post.user %>
              <%= link_to user_path(post.user), data: { turbo: false } do %>
                <span class="font-bold"><%= post.user.name %></span>
              <% end %>
            <% end %>
                <span class="flex">
                  <% if current_page?(feed_path) %>
                    <% if post.community_id %> <%= post.community.name %> <% elsif post.challenge_id %> <%= post.challenge.name %> <% else %> <% end %>
                  <% end %>
                    </span>
        </div>

        <div class="absolute right-[45px]">
          <% if post.user.id != current_user.id %>
            <%= render 'users/follow_button', user: post.user %>
          <% end %>
        </div>

        <div class="absolute right-[16px]">
          <div class="relative" data-controller="dropdown">
            <button type="button" class="border-none pointer text-base" data-action="click->dropdown#toggle">
              <i class="fa fa-ellipsis-v"></i>
            </button>

            <div class="hidden" data-dropdown-target="menu">
              <%= link_to "Report", new_post_report_path(post),
                          data: {
                            turbo_frame: "modal_frame",
                            action: "click->dropdown#close"
                          } %>
              <!-- Other menu items -->
            </div>
          </div>
        </div>
      </div>


    <div class="mb-[15px] text-base leading-[1.5] pl-[20px] pt-[15px] text-[#30284f]">
        <div class="pb-[20px]">
          <%= simple_format(post.content) %>
        </div>

        <% if post.media.attached? %>
         <div class="swiper" style="--swiper-navigation-color: #fff; --swiper-pagination-color: #fff;" data-controller="swiper">
             <div data-swiper-target="main" class="swiper-container">
           <div class="swiper-wrapper">
             <% post.media.each do |media| %>
                 <% if media.image? %>
                     <div class="swiper-slide" style="max-height: 400px;">
                       <%= image_tag media.variant(resize_to_limit: [1000, 500]), class: 'post-image' %>
                     </div>
                 <% elsif media.video? %>
                     <div class="swiper-slide" style="max-height: 400px;">
                        <%= video_tag rails_blob_path(media), controls: true, class: 'post-video', style: 'width: 100%; height: 400px' %>
                     </div>
             <% end %>

             <% end %>

           </div>
             <div class="swiper-pagination"></div>
             </div>
         </div>

         <% end %>
    </div>

    <div class="flex gap-2 pl-5">
      <%= render "posts/like_button", post: post %>

      <%= link_to post_comments_path(post),
                  data: { turbo_frame: "comments_panel" },
                  class: "inline-flex h-[20px] w-[40px]" do %>
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
          <% if post.comments.count > 0 %>
          <span class="relative bottom-[2px] left-[3px]"><%= post.comments.count %></span>
          <% end %>
      <% end %>
    </div>
  </div>
<% end %>
